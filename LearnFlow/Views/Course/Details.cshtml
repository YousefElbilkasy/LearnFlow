@using System.Security.Claims
@model LearnFlow.Models.Course

@{
  ViewData["Title"] = "Details";
}

<div class="container mt-5">
  <div class="row">
    <div class="col-md-6">
      <img src="@Model.ImageUrl" class="img-fluid rounded" alt="Course Image">
    </div>
    <div class="col-md-6">
      <h1 class="course-title display-4">@Model.Title</h1>
      <div class="course-description mt-3">
        <strong>Description:</strong>
        <p>@Model.Description</p>
      </div>
      <div class="course-price mt-3">
        <strong>Price:</strong>
        <p>@Html.DisplayFor(model => model.Price)</p>
      </div>
      <div class="course-creation-date mt-3">
        <strong>Creation Date:</strong>
        <p>@Html.DisplayFor(model => model.CreationDate)</p>
      </div>
      <div class="course-instructor mt-3">
        <strong>Instructor:</strong>
        <p>@Model.Instructor.FullName</p>
      </div>
      <div class="course-enrollments mt-3">
        <strong>Enrollments:</strong>
        <p>@Model.Enrollments.Count</p>
      </div>
      <div class="mt-4">
        <form asp-action="Enroll" asp-controller="Enrollment" method="get">
          <input type="hidden" name="courseId" value="@Model.CourseId" />
          <button type="submit" class="btn btn-primary">Enroll Now</button>
        </form>
      </div>
      <div class="mt-3">
        @if (User.IsInRole("Instructor") && int.Parse(User.FindFirstValue(ClaimTypes.NameIdentifier)) ==
        Model.InstructorId)
        {
          <a asp-action="Edit" asp-route-id="@Model.CourseId" class="btn btn-warning">Edit</a>
        }
        <a asp-action="Index" class="btn btn-secondary">Back to List</a>
      </div>
      <div class="course-reviews mt-3">
        <strong>Reviews:</strong>
        @foreach (var review in Model.Reviews)
        {
          <div class="card mt-2">
            <div class="card-body">
              <p>@review.ReviewText</p>
              <p>Rating: @review.Rating</p>
            </div>
          </div>
        }
      </div>
    </div>
  </div>
</div>
